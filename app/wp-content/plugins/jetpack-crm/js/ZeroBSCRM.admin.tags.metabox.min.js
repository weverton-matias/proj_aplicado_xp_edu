/*! For license information please see ZeroBSCRM.admin.tags.metabox.min.js.LICENSE.txt */
(()=>{var t={505:t=>{function zbsJS_drawTag(t,a){const n='<div class="ui small basic label black" data-id="'+a+'"><i class="window close icon zbs-remove-tag"></i> <span>'+t+"</span></div>";jQuery("#zbs-tags-wrap").append(n),setTimeout((function(){zbsJS_bindTags()}),0)}function zbsJS_bindTags(){jQuery(".zbs-remove-tag").off("click").on("click",(function(){const t=jQuery("span",jQuery(this).parent()).html(),a=window.zbsCRMJS_currentTags.indexOf(t);a>-1&&window.zbsCRMJS_currentTags.splice(a,1),jQuery(this).parent().remove(),zbscrm_JS_addDirty("zbs-tags")}))}function zbsJS_bindTagsInit(){jQuery("#zbs-add-tag-action").off("click").on("click",(function(){zbsJS_addTagAction(jQuery("#zbs-add-tag-value").val())})),jQuery("#zbs-add-tag-value").on("keypress",(function(t){13==t.keyCode&&zbsJS_addTagAction(jQuery("#zbs-add-tag-value").val())})),jQuery("#zbs-tag-suggestions-show-more").off("click").on("click",(function(){jQuery("#zbs-tag-suggestions-show-more").hide(),jQuery("#zbs-tag-suggestions-more-wrap").show()})),jQuery("#zbs-tag-suggestions-show-less").off("click").on("click",(function(){jQuery("#zbs-tag-suggestions-show-more").show(),jQuery("#zbs-tag-suggestions-more-wrap").hide()})),jQuery(".zbsTagSuggestion").off("click").on("click",(function(){zbsJS_addTagAction(jQuery(this).html())}))}function zbsJS_addTagAction(t){t&&-1===jQuery.inArray(t,window.zbsCRMJS_currentTags)&&(zbsJS_drawTag(t,-1),window.zbsCRMJS_currentTags.push(t),jQuery("#zbs-add-tag-value").val(""),zbscrm_JS_addDirty("zbs-tags"))}function zbsJS_addEmptyTag(t,a,n){if(!window.zbsTagManagerUpdateAJAXBlocker){window.zbsTagManagerUpdateAJAXBlocker=!0;const e={action:"zbs_add_tag",sec:window.zbscrmjs_secToken,objtype:window.zbsEditSettings.objdbname,tag:t};jQuery.ajax({type:"POST",url:ajaxurl,data:e,dataType:"json",timeout:2e4,success:function(t){"function"==typeof a&&a(t),window.zbsTagManagerUpdateAJAXBlocker=!1},error:function(t){"function"==typeof n&&n(t),window.zbsTagManagerUpdateAJAXBlocker=!1}})}}function zeroBSCRMJS_tagManager_bindTagEditButtons(){jQuery(".zbs-delete-tag").off("click").on("click",(function(){const t=parseInt(jQuery(this).attr("data-tagid"));t>0&&swal({title:window.zbsTagListLang.deleteswaltitle,text:window.zbsTagListLang.deleteswaltext,type:"warning",showCancelButton:!0,confirmButtonColor:"#000",cancelButtonColor:"#fff",cancelButtonText:'<span style="color: #000">Cancel</span>',confirmButtonText:window.zbsTagListLang.deleteswalconfirm,allowOutsideClick:!1}).then((function(a){if(a.value){const a={action:"zbs_delete_tag",tagid:t,sec:window.zbscrmjs_secToken};jQuery.ajax({type:"POST",url:ajaxurl,data:a,dataType:"json",timeout:2e4,success:function(){swal(window.zbsTagListLang.tagdeleted,window.zbsTagListLang.tagremoved,"success"),location.reload()},error:function(){swal(window.zbsTagListLang.tagnotdeleted,window.zbsTagListLang.tagnotremoved,"warning")}})}}))}))}window.zbsTagManagerUpdateAJAXBlocker=!1,t.exports={zeroBSCRMJS_buildTags:function(){"object"==typeof window.zbsCRMJS_currentTags&&jQuery.each(window.zbsCRMJS_currentTags,(function(t,a){void 0===window.zbsDontDrawTags&&zbsJS_drawTag(a,-1)})),setTimeout((function(){void 0===window.zbsCustomTagInitFunc?zbsJS_bindTagsInit():window[zbsCustomTagInitFunc]({})}),0)},zeroBSCRMJS_buildTagsInput:function(){const t=JSON.stringify(window.zbsCRMJS_currentTags);jQuery("#zbs-tag-list").val(t)},zbsJS_drawTag:zbsJS_drawTag,zbsJS_bindTags:zbsJS_bindTags,zbsJS_bindTagsInit:zbsJS_bindTagsInit,zbsJS_addTagAction:zbsJS_addTagAction,zbsJS_bindTagManagerInit:function(){zeroBSCRMJS_tagManager_bindTagEditButtons(),jQuery("#zbs-add-tag-action").off("click").on("click",(function(){const t=jQuery("#zbs-add-tag-value").val();t&&-1===jQuery.inArray(t,window.zbsCRMJS_currentTags)?zbsJS_addEmptyTag(t,(function(a){const n=t;let e=-1;void 0!==a.id&&(e=a.id);let s=n;void 0!==a.slug&&(s=a.slug),window.zbsCRMJS_currentTags.push(n),jQuery("#zbsNoTagResults").hide(),jQuery("#zbs-add-tag-value").val("");const o='<tr><td><span class="ui large label">'+n+"</span></td><td>"+s+'</td><td class="center aligned">0</td><td class="center aligned"><button type="button" class="ui mini button black zbs-delete-tag" data-tagid="'+e+'"><i class="trash alternate icon"></i> '+window.zbsTagListLang.delete+"</button></td></tr>";jQuery("#zbs-tag-manager tbody").append(o),setTimeout((function(){zeroBSCRMJS_tagManager_bindTagEditButtons()}),0)}),(function(){})):t?(jQuery("#zbsTagAlreadyExists").show().css("margin-bottom","1em"),setTimeout((function(){jQuery("#zbsTagAlreadyExists").hide()}),4e3)):(jQuery("#zbsTagEmpty").show().css("margin-bottom","1em"),setTimeout((function(){jQuery("#zbsTagEmpty").hide()}),4e3))})),jQuery("#zbs-add-tag-value").on("keypress",(function(t){13==t.keyCode&&(jQuery("#zbs-add-tag-action").trigger("click"),t.preventDefault())}))},zbsJS_addEmptyTag:zbsJS_addEmptyTag,zeroBSCRMJS_tagManager_bindTagEditButtons:zeroBSCRMJS_tagManager_bindTagEditButtons}}},a={};var n=function __webpack_require__(n){var e=a[n];if(void 0!==e)return e.exports;var s=a[n]={exports:{}};return t[n](s,s.exports,__webpack_require__),s.exports}(505),e=window="undefined"==typeof window?{}:window;for(var s in n)e[s]=n[s];n.__esModule&&Object.defineProperty(e,"__esModule",{value:!0})})();