(()=>{var e={830:e=>{jQuery((function(e){e(".inbox-nav .item").on("click",(function(){e(".inbox-nav .item").removeClass("active"),e(".zbs-email-list-item ").removeClass("active"),e("#zbs-email-body").hide(),e("#zbs-send-single-email, #zbs-send-single-email-ui").hide(),e("#zbs-email-send-message-thread").hide(),e(".click-email-to-load").show(),e(".zbs-ajax-loading").show(),e(this).addClass("active")})),e(".zbs-email-actions .star").on("click",(function(){if(e(this).hasClass("outline")){const a={action:"zbs_email_star_thread",emid:window.zbs_star_id,sec:window.zbs_root.zbsnonce};jQuery.ajax({type:"POST",url:ajaxurl,data:a,dataType:"json",timeout:2e4,success:function(){e(".zbs-list-fav-"+window.zbs_star_id).show()},error:function(){}}),e(this).addClass("yellow").removeClass("outline"),e(".starred-email-list .zbs-email-list-"+window.zbs_star_id).show()}else{const a={action:"zbs_email_unstar_thread",emid:window.zbs_star_id,sec:window.zbs_root.zbsnonce};jQuery.ajax({type:"POST",url:ajaxurl,data:a,dataType:"json",timeout:2e4,success:function(){e(".zbs-list-fav-"+window.zbs_star_id).hide()},error:function(){}}),e(this).removeClass("yellow").addClass("outline"),e(".starred-email-list .zbs-email-list-"+window.zbs_star_id).hide()}})),e(".zbs-inbox-compose-email").on("click",(function(a){a.preventDefault(),e(".zbs-email-list").hide(),e(".zbs-email-content").hide(),e(".zbs-email-contact-info").hide(),e("#zbs-send-single-email, #zbs-send-single-email-ui").show(),e(".inbox-nav .item").removeClass("active blue"),e(".zbs-email-list-item ").removeClass("active"),e(".zbs-drafts-link").addClass("active blue")})),e(".zbs-email-actions .trash").on("click",(function(){swal({title:"Are you sure?",text:"This will delete the email thread and remove it from your database. You can not undo this",type:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes delete the email!"}).then((function(a){if(a.value){const a=window.zbs_star_id,s={action:"zbs_delete_email_thread",emid:a,sec:window.zbs_root.zbsnonce};jQuery.ajax({type:"POST",url:ajaxurl,data:s,dataType:"json",timeout:2e4,success:function(){swal("Email thread deleted!","Your email thread has been removed.","success"),e("#zbs-email-body").hide(),e("#zbs-email-send-message-thread").hide(),e(".zbs-email-contact-info").hide(),e(".click-email-to-load").show(),e(".zbs-ajax-loading").show(),e(".zbs-email-list-"+a).remove()},error:function(){swal("Email Thread Not Deleted!","Your email thread was not removed, please try again.","warning")}})}}))})),e(".zbs-email-list-item").on("click",(function(){e(".zbs-email-thread").html(""),window.zbs_star_id=e(this).data("emid"),window.zbs_fav=e(this).data("fav"),window.zbs_cid=e(this).data("cid"),e(this).hasClass("zbs-unread-0")&&e(this).removeClass("zbs-unread-0").addClass("zbs-unread-1"),e(".edit-contact-link").attr("href",window.zbsContactEditPrefix+window.zbs_cid),e(".zbs-email-list-item").removeClass("active"),e(".click-email-to-load, .reply-sent").hide(),e(this).addClass("active"),1==window.zbs_fav?e(".zbs-email-actions .star").addClass("yellow").removeClass("outline"):e(".zbs-email-actions .star").removeClass("yellow").addClass("outline"),e(".zbs-email-read-date").hide(),e("#zbs-email-body").hide(),e(".zbs-ajax-loading").show(),e(".spinner-gif").show(),jQuery("#zbs-couldnotload").remove(),e(".spinner-gif").show();const a={action:"zbs_email_customer_panel",cid:e(this).data("cid"),emid:e(this).data("emid"),sec:window.zbs_root.zbsnonce};jQuery.ajax({type:"POST",url:ajaxurl,data:a,dataType:"json",timeout:2e4,success:function(a){e("#panel-customer-avatar").html(a.avatar),e("#panel-name").html(a.customer.fname+" "+a.customer.lname),e("#panel-status").html(a.customer.status),e(".panel-customer-email").html(a.customer.email),e(".panel-customer-phone").html(a.customer.hometel),e(".the-tasks").html("");let s=0,i=0,t=0;e.each(a.tasks,(function(a,l){t++,1==l.complete?(e(".the-tasks").append('<li class="complete"><i class="ui icon check green circle"></i>'+l.title+"</li>"),s++):(e(".the-tasks").append('<li class="incomplete">'+l.title+"</li>"),i++)})),0===t&&e(".the-tasks").html("<div class='no-tasks'>No Tasks for this contact</div>"),e(".total-tasks-panel").html(t),e(".completed-tasks-panel").html(s),e(".inprogress-tasks-panel").html(i),e(".total-paid .the_value").html(a.trans_value),e(".total-due .the_value").html(a.quote_value),e(".zbs-email-date").html(a.email_date),e(".zbs-email-subject").html(a.email.zbsmail_subject),e.each(a.email,(function(a,s){e(".zbs-email-thread").append('<div class="zbs-email-date>'+s.date+"</div>"),e(".zbs-email-thread").append('<div class="zbs-email-subject em-sub-'+a+'">'+jpcrm.esc_html(s.zbsmail_subject)+"</div>"),e(".zbs-email-thread").append('<div class="zbs-email-body-content '+s.in_or_out+'" id="zbsbody'+s.the_id+'">'+unescape(s.zbsmail_content)+"</div>"),e("#zbsbody"+s.the_id).append('<div class="pointer'+s.in_or_out+'"></div>'),e(".zbs-email-thread").append('<div class="email-avatar avatar-'+s.in_or_out+'">'+s.avatar+"</div>"),e(".zbs-email-thread").append('<div class="clear"></div>'),s.zbsmail_opened>0&&e(".zbs-email-thread").append('<div class="zbsread'+s.in_or_out+'"><span class="bold">Read:</span> '+s.zbsmail_lastopened+"</div>")})),1==a.email.zbsmail_opened?e(".zbs-email-read-date").show():e(".zbs-email-read-date").hide(),e(".zbs-email-content").css("background","white"),e(".zbs-ajax-loading").hide(),e(".click-email-to-load").hide(),e(".spinner-gif").hide(),jQuery("#zbs-couldnotload").remove(),e("#zbs-email-body").show(),e(".zbs-email-content").fadeIn(1e3),e(".zbs-email-contact-info").fadeIn(1e3),e("#zbs-email-send-message-thread").show()},error:function(){e(".mark-complete-task button").removeClass("disabled"),e(".spinner-gif").hide(),jQuery("#zbs-couldnotload").remove(),jQuery(".zbs-ajax-loading").append('<p id="zbs-couldnotload">'+zbsEmailSingleLang.couldnotload+"</p>")}})})),e(".zbs-sent-link").on("click",(function(){e(".app-content").hide(),e(".click-email-to-load").show(),e(".spinner-gif").hide(),e(".sent-email-list, .zbs-email-content").fadeIn(1e3)})),e(".zbs-starred-link").on("click",(function(){e(".app-content").hide(),e(".click-email-to-load").show(),e(".spinner-gif").hide(),e(".starred-email-list, .zbs-email-content").fadeIn(1e3)})),e(".zbs-send-email-thread-button").on("click",(function(){const a=window.zbs_star_id,s=tinymce.get("zbs_send_email_thread").getContent(),i={action:"zbs_email_send_thread_ui",emid:a,cid:window.zbs_cid,"zbs-send-email-title":e(".em-sub-0").html(),zbs_send_email_content:s,sec:window.zbs_root.zbsnonce};jQuery.ajax({type:"POST",url:ajaxurl,data:i,dataType:"json",timeout:2e4,success:function(){tinymce.get("zbs_send_email_thread").setContent(""),e("#zbs-email-body, #zbs-email-send-message-thread").hide(),e(".zbs-ajax-loading").show(),e(".zbs-ajax-loading").append('<div class="reply-sent"><i class="ui icon check green circle"></i></div>'),e(".reply-sent").append("<h3>Email Sent</h3>")},error:function(){}})}))})),e.exports={zbscrmjs_customer_setCustomerEmail:function(e){void 0!==e.id&&(jQuery("#zbs-send-email-to").val(e.email),document.getElementById("email_contact_selector").classList.toggle("hidden",""!==e.email))}}}},a={};var s=function __webpack_require__(s){var i=a[s];if(void 0!==i)return i.exports;var t=a[s]={exports:{}};return e[s](t,t.exports,__webpack_require__),t.exports}(830),i=window="undefined"==typeof window?{}:window;for(var t in s)i[t]=s[t];s.__esModule&&Object.defineProperty(i,"__esModule",{value:!0})})();